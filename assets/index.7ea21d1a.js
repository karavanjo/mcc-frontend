var L=Object.defineProperty;var b=(n,e,t)=>e in n?L(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var p=(n,e,t)=>(b(n,typeof e!="symbol"?e+"":e,t),t);import{j as x,R as u,A,r as i,C as S,S as d,a as m,F as y,b as g,c as O,P as R,t as M,M as j,T as D,O as I,V as F,d as U,e as k,f as B}from"./vendor.8d80cb08.js";const N=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}};N();const a=x.exports.jsx,V=x.exports.jsxs,v=u.createContext(null),G=({children:n})=>{const e="my-city-climate-pqkfg",t=new A({id:e}),[s,o]=i.exports.useState(null),r=async()=>{const l=S.anonymous();try{return await t.logIn(l),o(t.currentUser),t.currentUser}catch{return o(null),null}},c=async(l,h)=>{const P=S.emailPassword(l,h);try{return await t.logIn(P),o(t.currentUser),t.currentUser}catch{return o(null),null}},f=()=>{var l;s!==null&&((l=t.currentUser)==null||l.logOut(),o(null))};return a(v.Provider,{value:{logIn:c,logOut:f,user:s,anonymousIn:r},children:n})},C=()=>{const n=i.exports.useContext(v);if(n==null)throw new Error("useRealmApp() called outside of a RealmApp?");return n},E=u.createContext(null),T=({children:n})=>{const{user:e}=C(),[t,s]=i.exports.useState(null);return i.exports.useEffect(()=>{if(e!==null){const o=e.mongoClient("mongodb-atlas");s(o.db("mcc-climate"))}},[e]),a(E.Provider,{value:{db:t},children:n})},$=()=>{const n=i.exports.useContext(E);if(n==null)throw new Error("useMongoDB() called outside of a MongoDB?");return n};const w={climate:new d({image:new m({radius:5,fill:new y({color:"#FC9292"}),stroke:new g({color:"#C86767",width:1})})}),perception:new d({image:new m({radius:5,fill:new y({color:"#c0ddff"}),stroke:new g({color:"#5f97dc",width:1})})}),synoptic:new d({image:new m({radius:5,fill:new y({color:"#d0ffc0"}),stroke:new g({color:"#74d350",width:1})})})},q=n=>n.type=="k"?w.climate:n.type=="s"?w.synoptic:n.type=="pp"?w.perception:new d,_=n=>{const e=[];return n.forEach(t=>{const s=new O({geometry:new R(M(t.location.coordinates,"EPSG:4326","EPSG:3857")),name:t.name});s.type=t.type,s.setProperties({code:t.code,name:t.name,type:t.type}),e.push(s)}),e};function z(n){const e=i.exports.useRef(null);return i.exports.useEffect(()=>{const t=new j({target:e.current,layers:[new D({source:new I})],view:new F({projection:"EPSG:3857",center:M([19.105,52.107],"EPSG:4326","EPSG:3857"),zoom:6}),controls:[]});n.onMapCreate&&n.onMapCreate(t)},[]),a("div",{ref:e,className:"map-container"})}var K=u.memo(z,(n,e)=>!0);class Q extends u.Component{constructor(e){super(e);p(this,"map");p(this,"stationsLayer");p(this,"buildStationsLayer",()=>{if(!this.map)return;const e=this.map,t=_(this.props.stations),s=new U({source:new k({features:t}),style:q});e.addLayer(s),e.getView().fit(s.getSource().getExtent(),{padding:[50,50,50,50]}),e.on("pointermove",o=>{const r=e.getEventPixel(o.originalEvent),c=e.hasFeatureAtPixel(r);e.getViewport().style.cursor=c?"pointer":""}),this.stationsLayer=s})}componentDidUpdate(e){e.stations!==this.props.stations&&!this.stationsLayer&&this.map&&this.buildStationsLayer()}onMapCreate(e){this.map=e}render(){return a(K,{onMapCreate:e=>this.onMapCreate(e)})}}var Y="/mcc-frontend/assets/favicon.27019856.svg";function H(){const{anonymousIn:n,user:e}=C(),{db:t}=$(),[s,o]=i.exports.useState([]);i.exports.useEffect(()=>{async function c(){if(t){const f=await t.collection("stations").find({},{projection:{code:1,name:1,type:1,location:1}});o(f)}}c()},[t]),i.exports.useEffect(()=>{e||n()});let r;return s?r=a(Q,{stations:s}):r=a("span",{children:"loading"}),V("div",{className:"app",children:[a("div",{className:"logo",title:"My city's climate",children:a("img",{src:Y,alt:"My city's climate"})}),r]})}B.render(a(u.StrictMode,{children:a(G,{children:a(T,{children:a(H,{})})})}),document.getElementById("root"));
